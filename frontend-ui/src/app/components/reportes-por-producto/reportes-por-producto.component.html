<div>
  <h2>Reporte de Ventas por Producto</h2>
  <form (ngSubmit)="consultar()">
    <label>Desde:</label>
    <input type="date" [(ngModel)]="fromDate" name="fromDate" required>
    <label>Hasta:</label>
    <input type="date" [(ngModel)]="toDate" name="toDate" required>
    <button type="submit" [disabled]="loading">Consultar</button>
    <button type="button" (click)="descargarExcel()" [disabled]="loading">Descargar Excel</button>
    <button type="button" (click)="descargarPdf()" [disabled]="loading">Descargar PDF</button>
  </form>
  <div *ngIf="errorMsg" style="color:red">{{errorMsg}}</div>
  <div *ngIf="reportData.length">
    <table>
      <thead>
        <tr>
          <th>Producto</th>
          <th>Cantidad Vendida</th>
          <th>Ingresos Generados</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let prod of reportData">
          <td>{{prod.productName}}</td>
          <td>{{prod.totalSold}}</td>
          <td>{{prod.totalIncome | currency:'USD':true}}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>